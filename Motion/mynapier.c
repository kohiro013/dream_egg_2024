#include "motion.h"

#define TABLESIZE 		(256)					// 2の定数であること
#define	SUBBIT 			(8)
#define SUBINDEX 		(1 << SUBBIT)
#define I_PI 			(TABLESIZE * SUBINDEX)

const static float NAPIER_INTEGRAL[GOAL] = {
	0.789537f,		// Straight		(index : 4.f)
	0.603427f,		// Slalom_90	(index : 2.f)
	0.645643f,		// Slalom_90L	(index : 2.f)
	0.697414f,		// Slalom_180	(index : 2.5f)
	0.462122f,		// Slalom_45in	(index : 1.f)
	0.645643f,		// Slalom_135in	(index : 2.f)
	0.572669f,		// Slalom_90V	(index : 1.5f)
	0.697414f,		// Slalom_Kojima(index : 2.5f)
	0.462122f, 		// Slalom_45out	(index : 1.f)
	0.645643f		// Slalom_135out(index : 2.f)
};

const static uint16_t NAPIER_TABLE[GOAL][TABLESIZE + 1] = {
	// Straight
	{
		0,   227,   617,  1271,  2196,  3372,  4761,  6320,  8007,  9785,
		11623, 13493, 15374, 17249, 19105, 20931, 22720, 24465, 26163, 27811,
		29408, 30951, 32442, 33879, 35265, 36599, 37882, 39117, 40303, 41443,
		42538, 43590, 44599, 45568, 46498, 47390, 48245, 49066, 49853, 50607,
		51331, 52024, 52688, 53325, 53935, 54519, 55078, 55613, 56126, 56617,
		57086, 57535, 57964, 58374, 58767, 59141, 59499, 59840, 60166, 60477,
		60774, 61056, 61325, 61581, 61825, 62057, 62277, 62487, 62685, 62874,
		63053, 63222, 63382, 63534, 63677, 63812, 63940, 64060, 64173, 64280,
		64380, 64473, 64561, 64644, 64720, 64792, 64859, 64921, 64979, 65033,
		65082, 65128, 65170, 65209, 65245, 65277, 65307, 65334, 65359, 65381,
		65401, 65419, 65435, 65450, 65462, 65474, 65484, 65492, 65500, 65506,
		65512, 65517, 65521, 65524, 65526, 65529, 65530, 65532, 65533, 65534,
		65534, 65534, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535,
		65535, 65535, 65535, 65535, 65535, 65535, 65534, 65534, 65533, 65532,
		65531, 65529, 65527, 65525, 65522, 65518, 65513, 65508, 65502, 65495,
		65486, 65477, 65466, 65454, 65440, 65424, 65407, 65387, 65366, 65342,
		65315, 65286, 65255, 65220, 65182, 65141, 65096, 65048, 64995, 64939,
		64878, 64812, 64742, 64667, 64586, 64500, 64408, 64310, 64205, 64094,
		63976, 63851, 63718, 63577, 63428, 63270, 63104, 62928, 62742, 62547,
		62340, 62123, 61895, 61655, 61402, 61137, 60859, 60566, 60260, 59938,
		59601, 59249, 58879, 58492, 58087, 57664, 57221, 56757, 56273, 55767,
		55239, 54686, 54110, 53508, 52879, 52223, 51539, 50824, 50079, 49302,
		48491, 47646, 46765, 45847, 44890, 43892, 42853, 41771, 40645, 39472,
		38252, 36983, 35664, 34294, 32872, 31397, 29869, 28289, 26656, 24972,
		23240, 21464, 19648, 17800, 15929, 14048, 12173, 10323,  8524,  6807,
		5206,  3763,  2519,  1516,   781,   317,     0,
	},
	// Slalom_90
	{
		0,     0,     0,     0,     0,     0,     3,    15,    46,   112,
		228,   408,   662,   996,  1414,  1916,  2499,  3158,  3889,  4684,
		5537,  6441,  7389,  8375,  9394, 10439, 11505, 12588, 13683, 14787,
		15896, 17007, 18117, 19225, 20327, 21422, 22509, 23585, 24650, 25704,
		26743, 27769, 28781, 29777, 30758, 31723, 32672, 33605, 34521, 35420,
		36303, 37169, 38019, 38852, 39669, 40469, 41253, 42021, 42773, 43509,
		44229, 44934, 45624, 46298, 46958, 47603, 48233, 48849, 49451, 50039,
		50613, 51174, 51721, 52256, 52777, 53285, 53781, 54265, 54736, 55195,
		55643, 56078, 56502, 56915, 57316, 57707, 58086, 58455, 58813, 59160,
		59497, 59824, 60141, 60447, 60744, 61031, 61308, 61576, 61834, 62083,
		62323, 62553, 62775, 62987, 63190, 63385, 63570, 63747, 63915, 64075,
		64226, 64369, 64503, 64629, 64746, 64856, 64956, 65049, 65134, 65210,
		65279, 65339, 65391, 65435, 65471, 65499, 65519, 65531, 65535, 65531,
		65519, 65499, 65471, 65435, 65391, 65339, 65279, 65210, 65134, 65049,
		64956, 64856, 64746, 64629, 64503, 64369, 64226, 64075, 63915, 63747,
		63570, 63385, 63190, 62987, 62775, 62553, 62323, 62083, 61834, 61576,
		61308, 61031, 60744, 60447, 60141, 59824, 59497, 59160, 58813, 58455,
		58086, 57707, 57316, 56915, 56502, 56078, 55643, 55195, 54736, 54265,
		53781, 53285, 52777, 52256, 51721, 51174, 50613, 50039, 49451, 48849,
		48233, 47603, 46958, 46298, 45624, 44934, 44229, 43509, 42773, 42021,
		41253, 40469, 39669, 38852, 38019, 37169, 36303, 35420, 34521, 33605,
		32672, 31723, 30758, 29777, 28781, 27769, 26743, 25704, 24650, 23585,
		22509, 21422, 20327, 19225, 18117, 17007, 15896, 14787, 13683, 12588,
		11505, 10439,  9394,  8375,  7389,  6441,  5537,  4684,  3889,  3158,
		2499,  1916,  1414,   996,   662,   408,   228,   112,    46,    15,
			3,     0,     0,     0,     0,     0,     0,
	},
	// Slalom_90L
	{
		0,    92,   186,   333,   541,   817,  1166,  1588,  2083,  2647,
		3278,  3969,  4716,  5513,  6356,  7237,  8153,  9098, 10067, 11056,
		12062, 13080, 14107, 15141, 16178, 17217, 18254, 19289, 20319, 21342,
		22359, 23367, 24365, 25353, 26329, 27294, 28246, 29185, 30111, 31023,
		31922, 32806, 33676, 34531, 35372, 36199, 37011, 37808, 38591, 39360,
		40114, 40854, 41580, 42292, 42990, 43674, 44344, 45001, 45645, 46275,
		46892, 47497, 48089, 48668, 49235, 49789, 50332, 50863, 51382, 51889,
		52385, 52869, 53343, 53805, 54257, 54698, 55129, 55549, 55958, 56358,
		56748, 57128, 57498, 57858, 58209, 58551, 58883, 59206, 59520, 59825,
		60121, 60409, 60688, 60958, 61220, 61473, 61718, 61955, 62184, 62404,
		62617, 62822, 63018, 63207, 63389, 63562, 63728, 63887, 64038, 64181,
		64317, 64446, 64567, 64681, 64787, 64887, 64979, 65064, 65142, 65213,
		65277, 65334, 65383, 65426, 65461, 65490, 65512, 65526, 65534, 65534,
		65528, 65515, 65494, 65467, 65433, 65391, 65343, 65287, 65225, 65155,
		65078, 64994, 64903, 64805, 64700, 64587, 64467, 64340, 64205, 64063,
		63913, 63756, 63591, 63419, 63239, 63051, 62856, 62653, 62441, 62222,
		61995, 61759, 61516, 61264, 61003, 60735, 60457, 60171, 59877, 59573,
		59261, 58939, 58608, 58268, 57919, 57560, 57192, 56814, 56426, 56028,
		55620, 55201, 54773, 54334, 53884, 53423, 52951, 52469, 51975, 51469,
		50953, 50424, 49883, 49331, 48766, 48189, 47599, 46997, 46382, 45754,
		45112, 44458, 43790, 43108, 42412, 41703, 40980, 40242, 39490, 38724,
		37944, 37149, 36339, 35515, 34676, 33823, 32956, 32074, 31178, 30268,
		29345, 28408, 27458, 26496, 25521, 24535, 23539, 22532, 21517, 20495,
		19466, 18432, 17395, 16356, 15319, 14284, 13256, 12236, 11228, 10235,
		9262,  8313,  7392,  6504,  5655,  4849,  4093,  3392,  2751,  2175,
		1668,  1233,   872,   583,   364,   207,     0,
	},
	// Slalom_180
	{
		0,   123,   272,   512,   855,  1309,  1875,  2547,  3319,  4182,
		5124,  6136,  7206,  8325,  9483, 10673, 11885, 13115, 14355, 15600,
		16846, 18089, 19325, 20552, 21767, 22967, 24152, 25320, 26469, 27598,
		28708, 29797, 30864, 31910, 32934, 33937, 34917, 35876, 36813, 37728,
		38622, 39494, 40346, 41177, 41987, 42778, 43549, 44300, 45032, 45745,
		46440, 47117, 47777, 48418, 49043, 49651, 50243, 50819, 51379, 51923,
		52453, 52968, 53468, 53954, 54427, 54885, 55331, 55763, 56183, 56590,
		56985, 57368, 57739, 58098, 58447, 58784, 59111, 59426, 59732, 60027,
		60312, 60588, 60854, 61110, 61357, 61596, 61825, 62046, 62258, 62461,
		62657, 62845, 63024, 63196, 63361, 63518, 63668, 63810, 63946, 64075,
		64197, 64313, 64423, 64526, 64623, 64714, 64800, 64880, 64954, 65023,
		65087, 65145, 65199, 65248, 65293, 65333, 65368, 65400, 65428, 65452,
		65472, 65489, 65503, 65514, 65523, 65529, 65532, 65534, 65535, 65535,
		65534, 65532, 65527, 65521, 65512, 65500, 65485, 65468, 65446, 65421,
		65393, 65360, 65323, 65282, 65236, 65186, 65131, 65071, 65006, 64936,
		64860, 64779, 64692, 64600, 64501, 64396, 64285, 64168, 64044, 63913,
		63776, 63631, 63480, 63321, 63155, 62981, 62799, 62610, 62412, 62206,
		61992, 61769, 61538, 61297, 61048, 60789, 60521, 60243, 59955, 59658,
		59350, 59031, 58702, 58362, 58011, 57648, 57274, 56889, 56491, 56080,
		55658, 55222, 54773, 54311, 53836, 53346, 52842, 52324, 51791, 51242,
		50678, 50099, 49503, 48891, 48262, 47616, 46952, 46271, 45571, 44853,
		44116, 43360, 42585, 41790, 40974, 40138, 39281, 38403, 37504, 36584,
		35642, 34678, 33692, 32684, 31654, 30603, 29530, 28436, 27322, 26187,
		25033, 23861, 22673, 21468, 20250, 19021, 17783, 16539, 15293, 14048,
		12811, 11585, 10377,  9195,  8045,  6937,  5880,  4885,  3961,  3120,
		2372,  1725,  1187,   761,   444,   228,     0,
	},
	// Slalom_45in
	{
		0,    36,    57,    86,   126,   178,   242,   322,   418,   532,
		664,   815,   987,  1179,  1392,  1626,  1881,  2158,  2455,  2772,
		3110,  3468,  3844,  4239,  4653,  5083,  5530,  5993,  6471,  6963,
		7469,  7988,  8520,  9063,  9616, 10181, 10754, 11337, 11928, 12527,
		13133, 13745, 14363, 14988, 15617, 16250, 16888, 17529, 18174, 18821,
		19471, 20123, 20777, 21432, 22089, 22746, 23404, 24062, 24720, 25377,
		26035, 26691, 27347, 28002, 28655, 29307, 29958, 30607, 31254, 31899,
		32542, 33182, 33821, 34456, 35090, 35720, 36348, 36973, 37596, 38215,
		38832, 39445, 40055, 40662, 41266, 41867, 42464, 43058, 43649, 44237,
		44821, 45401, 45979, 46552, 47123, 47690, 48253, 48813, 49369, 49922,
		50472, 51018, 51560, 52100, 52635, 53167, 53696, 54221, 54743, 55261,
		55776, 56288, 56796, 57301, 57802, 58300, 58795, 59286, 59774, 60259,
		60740, 61218, 61693, 62165, 62634, 63099, 63561, 64020, 64476, 64929,
		65379, 65243, 64793, 64339, 63882, 63422, 62959, 62492, 62023, 61550,
		61074, 60595, 60113, 59627, 59138, 58645, 58150, 57651, 57148, 56643,
		56134, 55621, 55105, 54586, 54063, 53537, 53007, 52474, 51937, 51397,
		50853, 50306, 49756, 49202, 48644, 48083, 47519, 46951, 46379, 45804,
		45226, 44645, 44059, 43471, 42879, 42284, 41686, 41084, 40479, 39871,
		39260, 38646, 38028, 37408, 36785, 36159, 35530, 34899, 34265, 33628,
		32989, 32348, 31704, 31059, 30411, 29762, 29111, 28458, 27804, 27149,
		26493, 25836, 25179, 24521, 23863, 23205, 22547, 21890, 21234, 20580,
		19926, 19275, 18626, 17979, 17335, 16695, 16058, 15426, 14798, 14176,
		13559, 12949, 12345, 11749, 11160, 10580, 10009,  9448,  8897,  8358,
		7830,  7315,  6813,  6325,  5851,  5393,  4951,  4526,  4118,  3729,
		3358,  3006,  2674,  2363,  2072,  1802,  1553,  1325,  1119,   933,
		767,   622,   495,   387,   296,   221,     0,
	},
	// Slalom_135in
	{
		0,    92,   186,   333,   541,   817,  1166,  1588,  2083,  2647,
		3278,  3969,  4716,  5513,  6356,  7237,  8153,  9098, 10067, 11056,
		12062, 13080, 14107, 15141, 16178, 17217, 18254, 19289, 20319, 21342,
		22359, 23367, 24365, 25353, 26329, 27294, 28246, 29185, 30111, 31023,
		31922, 32806, 33676, 34531, 35372, 36199, 37011, 37808, 38591, 39360,
		40114, 40854, 41580, 42292, 42990, 43674, 44344, 45001, 45645, 46275,
		46892, 47497, 48089, 48668, 49235, 49789, 50332, 50863, 51382, 51889,
		52385, 52869, 53343, 53805, 54257, 54698, 55129, 55549, 55958, 56358,
		56748, 57128, 57498, 57858, 58209, 58551, 58883, 59206, 59520, 59825,
		60121, 60409, 60688, 60958, 61220, 61473, 61718, 61955, 62184, 62404,
		62617, 62822, 63018, 63207, 63389, 63562, 63728, 63887, 64038, 64181,
		64317, 64446, 64567, 64681, 64787, 64887, 64979, 65064, 65142, 65213,
		65277, 65334, 65383, 65426, 65461, 65490, 65512, 65526, 65534, 65534,
		65528, 65515, 65494, 65467, 65433, 65391, 65343, 65287, 65225, 65155,
		65078, 64994, 64903, 64805, 64700, 64587, 64467, 64340, 64205, 64063,
		63913, 63756, 63591, 63419, 63239, 63051, 62856, 62653, 62441, 62222,
		61995, 61759, 61516, 61264, 61003, 60735, 60457, 60171, 59877, 59573,
		59261, 58939, 58608, 58268, 57919, 57560, 57192, 56814, 56426, 56028,
		55620, 55201, 54773, 54334, 53884, 53423, 52951, 52469, 51975, 51469,
		50953, 50424, 49883, 49331, 48766, 48189, 47599, 46997, 46382, 45754,
		45112, 44458, 43790, 43108, 42412, 41703, 40980, 40242, 39490, 38724,
		37944, 37149, 36339, 35515, 34676, 33823, 32956, 32074, 31178, 30268,
		29345, 28408, 27458, 26496, 25521, 24535, 23539, 22532, 21517, 20495,
		19466, 18432, 17395, 16356, 15319, 14284, 13256, 12236, 11228, 10235,
		9262,  8313,  7392,  6504,  5655,  4849,  4093,  3392,  2751,  2175,
		1668,  1233,   872,   583,   364,   207,     0,
	},
	// Slalom_90V
	{
		0,    64,   116,   193,   300,   442,   622,   842,  1105,  1410,
		1759,  2151,  2584,  3057,  3568,  4115,  4696,  5309,  5950,  6619,
		7312,  8027,  8762,  9515, 10283, 11065, 11860, 12664, 13477, 14297,
		15123, 15954, 16787, 17623, 18459, 19296, 20132, 20966, 21798, 22627,
		23452, 24273, 25090, 25901, 26706, 27505, 28298, 29085, 29864, 30636,
		31401, 32158, 32908, 33649, 34383, 35108, 35825, 36533, 37233, 37925,
		38608, 39282, 39948, 40605, 41253, 41893, 42524, 43147, 43761, 44366,
		44963, 45551, 46131, 46702, 47265, 47819, 48365, 48903, 49432, 49953,
		50466, 50971, 51467, 51955, 52436, 52908, 53372, 53829, 54277, 54717,
		55150, 55575, 55992, 56401, 56802, 57196, 57581, 57960, 58330, 58693,
		59048, 59395, 59734, 60066, 60390, 60706, 61014, 61314, 61607, 61891,
		62167, 62435, 62694, 62946, 63188, 63422, 63647, 63862, 64069, 64265,
		64452, 64627, 64792, 64945, 65086, 65213, 65325, 65420, 65493, 65535,
		65498, 65427, 65333, 65223, 65097, 64957, 64805, 64641, 64466, 64281,
		64085, 63880, 63665, 63441, 63207, 62966, 62715, 62456, 62189, 61914,
		61630, 61338, 61039, 60731, 60416, 60093, 59762, 59423, 59076, 58722,
		58360, 57990, 57613, 57227, 56834, 56434, 56025, 55609, 55185, 54753,
		54313, 53865, 53410, 52946, 52475, 51995, 51507, 51012, 50508, 49995,
		49475, 48947, 48410, 47864, 47311, 46749, 46178, 45599, 45012, 44415,
		43811, 43198, 42576, 41945, 41306, 40658, 40002, 39337, 38663, 37981,
		37290, 36591, 35883, 35167, 34442, 33709, 32969, 32220, 31463, 30699,
		29928, 29149, 28363, 27570, 26771, 25967, 25156, 24340, 23519, 22695,
		21866, 21034, 20200, 19364, 18528, 17691, 16855, 16022, 15191, 14365,
		13544, 12730, 11925, 11130, 10346,  9577,  8823,  8086,  7369,  6675,
		6004,  5360,  4745,  4161,  3611,  3097,  2621,  2185,  1790,  1437,
		1128,   862,   638,   455,   310,   200,     0,
	},
	// Slalom_Kojima
	{
		0,   123,   272,   512,   855,  1309,  1875,  2547,  3319,  4182,
		5124,  6136,  7206,  8325,  9483, 10673, 11885, 13115, 14355, 15600,
		16846, 18089, 19325, 20552, 21767, 22967, 24152, 25320, 26469, 27598,
		28708, 29797, 30864, 31910, 32934, 33937, 34917, 35876, 36813, 37728,
		38622, 39494, 40346, 41177, 41987, 42778, 43549, 44300, 45032, 45745,
		46440, 47117, 47777, 48418, 49043, 49651, 50243, 50819, 51379, 51923,
		52453, 52968, 53468, 53954, 54427, 54885, 55331, 55763, 56183, 56590,
		56985, 57368, 57739, 58098, 58447, 58784, 59111, 59426, 59732, 60027,
		60312, 60588, 60854, 61110, 61357, 61596, 61825, 62046, 62258, 62461,
		62657, 62845, 63024, 63196, 63361, 63518, 63668, 63810, 63946, 64075,
		64197, 64313, 64423, 64526, 64623, 64714, 64800, 64880, 64954, 65023,
		65087, 65145, 65199, 65248, 65293, 65333, 65368, 65400, 65428, 65452,
		65472, 65489, 65503, 65514, 65523, 65529, 65532, 65534, 65535, 65535,
		65534, 65532, 65527, 65521, 65512, 65500, 65485, 65468, 65446, 65421,
		65393, 65360, 65323, 65282, 65236, 65186, 65131, 65071, 65006, 64936,
		64860, 64779, 64692, 64600, 64501, 64396, 64285, 64168, 64044, 63913,
		63776, 63631, 63480, 63321, 63155, 62981, 62799, 62610, 62412, 62206,
		61992, 61769, 61538, 61297, 61048, 60789, 60521, 60243, 59955, 59658,
		59350, 59031, 58702, 58362, 58011, 57648, 57274, 56889, 56491, 56080,
		55658, 55222, 54773, 54311, 53836, 53346, 52842, 52324, 51791, 51242,
		50678, 50099, 49503, 48891, 48262, 47616, 46952, 46271, 45571, 44853,
		44116, 43360, 42585, 41790, 40974, 40138, 39281, 38403, 37504, 36584,
		35642, 34678, 33692, 32684, 31654, 30603, 29530, 28436, 27322, 26187,
		25033, 23861, 22673, 21468, 20250, 19021, 17783, 16539, 15293, 14048,
		12811, 11585, 10377,  9195,  8045,  6937,  5880,  4885,  3961,  3120,
		2372,  1725,  1187,   761,   444,   228,     0,
	},
	// Slalom_45out
	{
		0,    36,    57,    86,   126,   178,   242,   322,   418,   532,
		664,   815,   987,  1179,  1392,  1626,  1881,  2158,  2455,  2772,
		3110,  3468,  3844,  4239,  4653,  5083,  5530,  5993,  6471,  6963,
		7469,  7988,  8520,  9063,  9616, 10181, 10754, 11337, 11928, 12527,
		13133, 13745, 14363, 14988, 15617, 16250, 16888, 17529, 18174, 18821,
		19471, 20123, 20777, 21432, 22089, 22746, 23404, 24062, 24720, 25377,
		26035, 26691, 27347, 28002, 28655, 29307, 29958, 30607, 31254, 31899,
		32542, 33182, 33821, 34456, 35090, 35720, 36348, 36973, 37596, 38215,
		38832, 39445, 40055, 40662, 41266, 41867, 42464, 43058, 43649, 44237,
		44821, 45401, 45979, 46552, 47123, 47690, 48253, 48813, 49369, 49922,
		50472, 51018, 51560, 52100, 52635, 53167, 53696, 54221, 54743, 55261,
		55776, 56288, 56796, 57301, 57802, 58300, 58795, 59286, 59774, 60259,
		60740, 61218, 61693, 62165, 62634, 63099, 63561, 64020, 64476, 64929,
		65379, 65243, 64793, 64339, 63882, 63422, 62959, 62492, 62023, 61550,
		61074, 60595, 60113, 59627, 59138, 58645, 58150, 57651, 57148, 56643,
		56134, 55621, 55105, 54586, 54063, 53537, 53007, 52474, 51937, 51397,
		50853, 50306, 49756, 49202, 48644, 48083, 47519, 46951, 46379, 45804,
		45226, 44645, 44059, 43471, 42879, 42284, 41686, 41084, 40479, 39871,
		39260, 38646, 38028, 37408, 36785, 36159, 35530, 34899, 34265, 33628,
		32989, 32348, 31704, 31059, 30411, 29762, 29111, 28458, 27804, 27149,
		26493, 25836, 25179, 24521, 23863, 23205, 22547, 21890, 21234, 20580,
		19926, 19275, 18626, 17979, 17335, 16695, 16058, 15426, 14798, 14176,
		13559, 12949, 12345, 11749, 11160, 10580, 10009,  9448,  8897,  8358,
		7830,  7315,  6813,  6325,  5851,  5393,  4951,  4526,  4118,  3729,
		3358,  3006,  2674,  2363,  2072,  1802,  1553,  1325,  1119,   933,
		767,   622,   495,   387,   296,   221,     0,
	},
	// Slalom_135out
	{
		0,    92,   186,   333,   541,   817,  1166,  1588,  2083,  2647,
		3278,  3969,  4716,  5513,  6356,  7237,  8153,  9098, 10067, 11056,
		12062, 13080, 14107, 15141, 16178, 17217, 18254, 19289, 20319, 21342,
		22359, 23367, 24365, 25353, 26329, 27294, 28246, 29185, 30111, 31023,
		31922, 32806, 33676, 34531, 35372, 36199, 37011, 37808, 38591, 39360,
		40114, 40854, 41580, 42292, 42990, 43674, 44344, 45001, 45645, 46275,
		46892, 47497, 48089, 48668, 49235, 49789, 50332, 50863, 51382, 51889,
		52385, 52869, 53343, 53805, 54257, 54698, 55129, 55549, 55958, 56358,
		56748, 57128, 57498, 57858, 58209, 58551, 58883, 59206, 59520, 59825,
		60121, 60409, 60688, 60958, 61220, 61473, 61718, 61955, 62184, 62404,
		62617, 62822, 63018, 63207, 63389, 63562, 63728, 63887, 64038, 64181,
		64317, 64446, 64567, 64681, 64787, 64887, 64979, 65064, 65142, 65213,
		65277, 65334, 65383, 65426, 65461, 65490, 65512, 65526, 65534, 65534,
		65528, 65515, 65494, 65467, 65433, 65391, 65343, 65287, 65225, 65155,
		65078, 64994, 64903, 64805, 64700, 64587, 64467, 64340, 64205, 64063,
		63913, 63756, 63591, 63419, 63239, 63051, 62856, 62653, 62441, 62222,
		61995, 61759, 61516, 61264, 61003, 60735, 60457, 60171, 59877, 59573,
		59261, 58939, 58608, 58268, 57919, 57560, 57192, 56814, 56426, 56028,
		55620, 55201, 54773, 54334, 53884, 53423, 52951, 52469, 51975, 51469,
		50953, 50424, 49883, 49331, 48766, 48189, 47599, 46997, 46382, 45754,
		45112, 44458, 43790, 43108, 42412, 41703, 40980, 40242, 39490, 38724,
		37944, 37149, 36339, 35515, 34676, 33823, 32956, 32074, 31178, 30268,
		29345, 28408, 27458, 26496, 25521, 24535, 23539, 22532, 21517, 20495,
		19466, 18432, 17395, 16356, 15319, 14284, 13256, 12236, 11228, 10235,
		9262,  8313,  7392,  6504,  5655,  4849,  4093,  3392,  2751,  2175,
		1668,  1233,   872,   583,   364,   207,     0,
	}
};

float Mynapier_Calc(int8_t type, float ms)
{
	long	ix,	subix,	tval;

	if(ms < 0.f || 1.f < ms) {
		return 0.f;
	} else {
		ix = (int)(ms * I_PI);			// 単位変換
		subix = ix & (SUBINDEX - 1);	// 線形補完に用いるサブインデックス
		ix >>= SUBBIT;					// テーブル番号に変換

		// 線形補間
		tval = ((long)NAPIER_TABLE[type][ix] * (SUBINDEX - subix) + (long)NAPIER_TABLE[type][ix+1] * subix);

		return(tval / (SUBINDEX * 65535.f));
	}
}

float Mynapier_GetIntegral(int8_t type)
{
	return NAPIER_INTEGRAL[type];
}
